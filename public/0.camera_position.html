<!DOCTYPE html>
<html lang="en">

<head>
	<title>webxr - Share AR</title>
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
	<meta name="author" content="based in Irene Alvarado class Example">
	<link type="text/css" rel="stylesheet" href="../main.css">
</head>

<body>
	<div id="overlay-ui">
	</div>
	<div id="console-ui">
	</div>

	<script src="//cdn.jsdelivr.net/npm/eruda"></script>
	<script>
		eruda.init({
			container: document.getElementById('console-ui')
		});
	</script>

	<script type="module">

		import * as THREE from '../threejs/three.module.js';
		import { ARButton } from '../threejs/jsm/webxr/ARButton.js';
		// import { GLTFLoader } from '../threejs/jsm/loaders/GLTFLoader.js';
		// import { GUI } from '../threejs/jsm/libs/dat.gui.module.js';

		let container;
		let camera, scene, renderer;

		let posXArray = [262.4806262610278, 255.4986440338691, 253.00679519275246, 244.4753660800748, 242.86634413531087, 245.31528097140915, 240.87663134192923, 234.58186787876969, 232.24662630302083, 233.65075956478316, 227.98737839560488, 234.6270261933563, 225.82213489414767, 219.7991804726317, 213.98911759207743, 206.8725251966891, 201.16470852645037, 187.6070003234778, 175.0100001867772, 176.68743130789628, 179.3807286671761, 195.41916139240553, 213.31820433087745, 240.02568764221442, 259.7285205127263, 279.099659828056, 327.48145421907435, 366.62923726030346, 393.29719434050844, 436.24424244725617, 477.1537594812452, 512.4232329097965, 542.3772184185499, 571.2417359258494, 613.904482807357, 633.8059837401198, 664.8199011129506, 683.6200188426352, 696.8791417826861, 704.7755867709425, 693.8688049318503, 677.335191479973, 637.6050101549456, 605.3343681492113, 560.2426930418383, 541.4348717607404, 509.89474986418503, 471.4940210893109, 455.38176455434143, 421.8157061597144, 389.89077659632426, 359.5916203089751, 325.72743449711504, 277.792564794952, 237.80274228643577, 229.9543140072026, 231.28659292426724, 220.06098219397785, 164.8625409270817, 176.2373366935879, 180.85233939724685, 200.76296938442783, 230.18989361937608, 256.6732746513367, 283.27121116338003, 287.2262551279188, 316.0347670154935, 341.33343349041354, 379.76041857652024, 393.20582545819735, 414.3960329545262, 434.0553474586652, 453.5284603437395, 476.71825866295694, 501.2160957645095, 530.136011188644, 546.0521139842402, 560.3068334057242, 562.8817061019867, 570.257639039402, 565.8110660926367, 561.8406354272577, 551.7444473832652, 540.7354198758369, 480.99573979838755, 440.7502923421701, 423.3302234757358, 399.6751286740833, 381.40870222371234, 325.235453272914, 299.50457999708595, 282.4756371878624, 274.01585461520045, 188.0400730182185, 157.1806902479765, 173.63886201212765, 187.58793422732523, 202.23445161716333, 258.055885364295, 283.35466335397757, 291.82899134619726, 285.735062918262, 287.93930082829405, 289.12140052418664, 312.95263926940277, 320.51747032788734, 325.09262826644806, 341.9753226798327, 354.3420839052949, 352.4043075023272, 322.5123125632366, 326.9566534682434, 306.4686224876687, 302.37077485055926, 301.5145413994672, 310.00127589277724, 316.32750927340453, 319.50579911108355, 322.8836900763396, 331.27164877624773, 335.73247455903766, 341.0899640424162, 342.3647195571398, 354.78319079779055, 353.4681264863009, 349.24215383906363, 353.7665359634688, 351.7437443983888, 345.0751489860567, 345.22999681041705, 345.0823991959867, 334.132434484083, 343.92498547555067, 349.4879088298517, 347.99876172991515, 338.9837901312375, 325.22833332353053, 320.5494420961374, 311.3160637018781, 286.82815842364516, 280.91216109403643, 289.5866459987045, 205.66253966413512, 199.65777288872314, 165.3109641841429, 153.9654435810029, 154.8367412719135, 182.0355822545707, 188.24060367430172, 276.1881332198866, 301.5857176404176, 335.5149096238939, 347.756832374938, 369.99059625037376, 398.97810967383674, 419.3452182149383, 435.8842405491066, 502.26146852870977, 524.60313793837, 545.3386424774873, 555.7397015162403, 572.7306728971555, 589.2330927215274, 609.4626590379239]
        let posYArray = [330.139824401762, 328.13348420667717, 325.38195794598533, 325.3903679175942, 323.3233703617636, 328.27458416329614, 331.9578716857126, 330.7034479511491, 325.87049769454984, 327.4699193087939, 315.4245441485659, 310.34535957276955, 300.9345098943767, 289.6067671226858, 280.1863851243976, 266.3232853050092, 252.7645362709301, 222.65193196668184, 197.50581144617544, 183.72309662568736, 171.1512143134784, 163.41250574326654, 162.7368317687597, 159.4830857880127, 153.08462232948747, 149.75523279139475, 153.1849084257038, 156.19468630633793, 156.14248080025288, 152.6563256750388, 142.57768503847967, 153.493985414591, 154.88243490851193, 154.27632257971894, 156.9705551227883, 160.0565088475335, 164.6589103422153, 171.86751940643637, 176.88485802808492, 184.03714020521645, 188.88105779081673, 188.92371208766127, 175.4279282141631, 172.1837130272255, 189.33576819660968, 193.0249059848016, 185.3179859627972, 207.04045119728906, 187.4778524465345, 190.5985569842136, 179.60952655288787, 201.3295030582989, 194.41811397680888, 217.0798761976513, 211.7708221892305, 207.92173777299712, 211.65882377654086, 214.6735090602823, 208.59797331892756, 201.96863082419708, 199.02205941739015, 192.52192456568687, 183.0346030439971, 163.0062925605036, 164.39209550522884, 157.656367937908, 148.5609091253238, 150.01931764299383, 144.29589605023824, 148.71640503328877, 146.71280773721492, 137.22910272467146, 135.52018507672125, 143.4955806945246, 145.63959578040607, 153.13679161403618, 161.61232724190245, 172.55984107827828, 181.57775264560735, 195.58605170916366, 198.3779082060156, 204.39459955249427, 203.98049444342456, 214.27450284967247, 235.11262282114507, 229.7169610405458, 233.44951621689876, 233.92977118264298, 229.90716189940883, 247.6069317852305, 232.28713713393302, 233.07639995642324, 232.64911490807603, 179.82212213746513, 162.99726039365154, 150.08944411910448, 126.13410886032099, 107.813778269713, 50.78472225908848, 36.41140915253041, 35.481026959453175, 37.01567518501767, 55.46059350960884, 80.45684031779697, 138.62685156088685, 168.1342312953911, 178.41196461057856, 202.56300558338063, 292.6031899316082, 326.73409510663464, 365.89544967930954, 310.6042568556843, 262.8969215846213, 218.9667586163811, 178.37580545410958, 135.9893478148886, 129.42574900528874, 108.81735416765386, 95.86361182641355, 87.42998632868242, 70.03945486608447, 60.62282500762828, 54.98043817275132, 53.35664789936595, 70.8893658099652, 72.93709792734924, 87.09991066917887, 101.25313021454437, 111.92285341733603, 151.00715978409914, 184.60927941418697, 190.3613270303756, 217.5863261488798, 226.97553814110734, 283.06182610726523, 276.22195616276014, 265.82856119883775, 257.95801028868294, 258.97555665368617, 246.2032612878655, 251.6487848266508, 250.0599520822283, 237.17101773147292, 226.59876105031418, 218.06135560459623, 210.46157979607992, 205.8212542378459, 211.77578636738363, 207.7106773191912, 197.98807457757738, 185.79591481367478, 181.94056650829594, 188.30707430366706, 166.91456820637356, 172.35724858107784, 173.42019743326466, 157.47617355595935, 181.41447525805222, 174.8685329637647, 192.77180101378804, 204.9421331434927, 218.1753956768498, 230.27813869458464, 248.225391049221]
        let eachPos = 0;

		init();
		animate();

		function init() {
			container = document.createElement('div');
			document.body.appendChild(container);

			// All three.js scenes need three things: a scene, a camera, and a renderer
			// For more info read: https://threejs.org/docs/#manual/en/introduction/Creating-a-scene

			// #1 create the scene, although there's nothing in it just yet
			scene = new THREE.Scene();
			// Box
			var box = getBox(1, 1, 1);
            box.name = 'box-1';
            box.position.y = box.geometry.parameters.height/2;
			// sphere
			var orb = getOrb(1, 20, 20);
            orb.name = 'orb-1';
            orb.position.y = orb.geometry.parameters.height/2;

			// #2 create the camera
			camera = new THREE.PerspectiveCamera(70, window.innerWidth / window.innerHeight, 0.01, 20);

			// #3 Pick a three.js renderer
			renderer = new THREE.WebGLRenderer({ antialias: true, alpha: true });
			renderer.setPixelRatio(window.devicePixelRatio);
			renderer.setSize(window.innerWidth, window.innerHeight);
			renderer.xr.enabled = true; // we have to enable the renderer for webxr
			container.appendChild(renderer.domElement);


            var light = new THREE.HemisphereLight(0xffffff, 0xbbbbff, 1);
            light.position.set(0.5, 1, 0.25);
            scene.add(light);
            scene.add(box);
			scene.add(orb);


			// Add an AR button to the window
			// Specifying we have a DOM overlay (the GUI UI)
			document.body.appendChild(ARButton.createButton(renderer, {
				optionalFeatures: ['dom-overlay'],
				domOverlay: { root: document.body }
			}));
			renderer.domElement.style.display = 'none'; // need to add this to see the UI

			window.addEventListener('resize', onWindowResize, false);

			setInterval(logCameraPosition, 1000);
			// setInterval(logCameraRotation, 1000);
		}

		function onWindowResize() {
			camera.aspect = window.innerWidth / window.innerHeight;
			camera.updateProjectionMatrix();

			renderer.setSize(window.innerWidth, window.innerHeight);
		}

		// this function is only called one time
		function animate() {
			// here we set the render function to be called in a loop
			renderer.setAnimationLoop(render);
		}

		// render function called on a loop every time the screen is refreshed
		// which typically means 60 times a second (60 frames per second)
		function render() {
			//********************cube moving********************
            var boxMove = scene.getObjectByName('box-1');
            boxMove.rotation.y += 0.01;
            if(eachPos > posXArray.length-1){
                eachPos = 0;
            }
            boxMove.position.z = -4;
			boxMove.position.x= 0;
            boxMove.position.y = 0;
            // boxMove.position.x = posXArray[eachPos]/1000;
            // boxMove.position.y = posYArray[eachPos]/1000;

            eachPos +=1;

		//********************Sphere moving********************
			var OrbMove = scene.getObjectByName('orb-1');
			// boxMove.rotation.y += 0.01;
            OrbMove.position.z = -6;
			OrbMove.position.x=  2;
            OrbMove.position.y = 0;

          

			renderer.render(scene, camera);
		}

		function logCameraPosition() {
			const position = new THREE.Vector3();
			position.setFromMatrixPosition(camera.matrixWorld); // x, y, z
			console.log(position); // x, y, z
		}

		function logCameraRotation() {
			const rotation = new THREE.Quaternion();
			rotation.setFromRotationMatrix(camera.matrixWorld);
			console.log(rotation);
		}

        // ****************************************************************


		function getBox(w, h, d) {
			var geometry = new THREE.BoxGeometry(w, h, d);
			var material = new THREE.MeshBasicMaterial({
				color: 0xCCCC00
			});
			var mesh = new THREE.Mesh(
				geometry,
				material 
			);

			return mesh;
		}

		function getOrb(w, h, d) {
			var geometry = new THREE.SphereGeometry(w, h, d);
			var material = new THREE.MeshBasicMaterial({
				color: 0xeb6134
			});
			var mesh = new THREE.Mesh(
				geometry,
				material 
			);
			return mesh;
		}

	</script>
</body>

</html>